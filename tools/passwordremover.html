<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bulk Password Remover - PDF & Excel | EffortlesslyDone</title>
  <meta name="description" content="Free online tool to remove passwords from multiple PDF or Excel files in bulk. Process securely in your browser, no installation required." />
  <meta name="keywords" content="bulk pdf password remover, excel unlocker, remove pdf password online, remove excel password, batch file unlock" />
  <meta name="author" content="EffortlesslyDone" />
  
  <!-- Main site styles & fonts -->
  <link rel="stylesheet" href="../style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
  
  <style>
/* Ensure fixed header stays constant and content doesn't overlap */
.header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 70px; /* lock header height */
  background-color: var(--color-surface);
  box-shadow: var(--shadow-sm);
  z-index: 1000;
}

main {
  padding-top: 90px; /* a bit more than header height for breathing room */
}

    /* Tool-specific overrides inside main theme */
    .tool-container {
      background: var(--color-surface);
      border-radius: var(--radius-base);
      box-shadow: var(--shadow-md);
      padding: var(--space-24);
      margin-top: var(--space-48);
    }
    label {
      display: block;
      margin: var(--space-16) 0 var(--space-8);
      font-weight: var(--font-weight-medium);
    }
    select, input[type="password"], input[type="file"] {
      width: 100%;
      padding: var(--space-12);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-sm);
      font-size: var(--font-size-base);
    }
    select:focus, input:focus {
      border-color: var(--color-primary);
      outline: none;
    }
    button.tool-btn {
      width: 100%;
      margin-top: var(--space-16);
    }
    #output {
      margin-top: var(--space-24);
      background: var(--color-background);
      padding: var(--space-16);
      border-radius: var(--radius-sm);
      box-shadow: var(--shadow-sm);
      max-height: 300px;
      overflow-y: auto;
    }
    .file-result.success { color: var(--color-success); }
    .file-result.error { color: var(--color-error); }
    a.download-link {
      margin-left: var(--space-8);
      font-weight: var(--font-weight-medium);
      color: var(--color-primary);
    }
    .promo {
      margin-top: var(--space-32);
      text-align: center;
      background: var(--color-bg-2);
      padding: var(--space-16);
      border-radius: var(--radius-sm);
    }
  </style>
</head>
<body>
  
  <!-- Site Header -->
  <header class="header">
    <div class="container header__content">
      <div class="header__logo">
        <h1><i class="fas fa-rocket"></i> EffortlesslyDone</h1>
      </div>
      <nav class="header__nav" id="nav">
        <a href="../index.html" class="nav-link">Home</a>
        <a href="../index.html#templates" class="nav-link">Templates</a>
        <a href="../index.html#tools" class="nav-link active">Tools</a>
        <a href="../index.html#games" class="nav-link">Games</a>
        <a href="../index.html#about" class="nav-link">About</a>
      </nav>
      <div class="header__search">
        <input type="text" id="searchInput" class="search-input" placeholder="Search...">
        <button id="searchBtn" class="btn btn--primary search-btn"><i class="fas fa-search"></i></button>
      </div>
      <button id="mobileMenuBtn" class="mobile-menu-btn">
        <span></span><span></span><span></span>
      </button>
    </div>
  </header>

  <main class="container">
    <section class="tool-container">
      <h2><i class="fas fa-unlock"></i> Bulk Password Remover - PDF & Excel</h2>
      <p>Unlock multiple PDF or Excel files in one go — right in your browser, safely and free.</p>
      <p class="small">Unlocked files are prefixed with <b>unlocked_</b>. Issues will be listed in the log.</p>

      <label for="fileType">Choose File Type:</label>
      <select id="fileType">
        <option value="pdf">PDF</option>
        <option value="excel">Excel (.xlsx)</option>
      </select>

      <label for="password">Enter Password (same for all files):</label>
      <input type="password" id="password" placeholder="Enter password" />

      <label for="files">Select Password-Protected Files:</label>
      <input type="file" id="files" multiple />

      <button id="processBtn" class="btn btn--primary tool-btn" disabled>Remove Passwords</button>
      <div id="output"></div>
      <button id="downloadLog" class="btn btn--secondary tool-btn" style="display:none;">Download Issue Log</button>

      <div class="promo">
             More automation tools on <a href="../index.html">← Back to Home</a><br>
        Contact: <a href="mailto:decomplicate001@gmail.com">decomplicate001@gmail.com</a>
      </div>
    </section>
  </main>

  <!-- Site Footer -->
  <footer class="footer">
    <div class="container footer__content">
      <div class="footer__section">
        <h3>EffortlesslyDone</h3>
        <p>Simplifying your digital life, one tool at a time.</p>
      </div>
            </div>
  </footer>

  <!-- Scripts -->
  <script src="../app.js" defer></script>
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

  <script>
    const fileTypeSelect = document.getElementById('fileType');
    const filesInput = document.getElementById('files');
    const passwordInput = document.getElementById('password');
    const processBtn = document.getElementById('processBtn');
    const output = document.getElementById('output');
    const downloadLogBtn = document.getElementById('downloadLog');
    let issueLog = [];

    fileTypeSelect.addEventListener('change', () => {
      output.innerHTML = '';
      passwordInput.value = '';
      filesInput.value = '';
      toggleButton();
      filesInput.accept = fileTypeSelect.value === 'pdf'
        ? 'application/pdf'
        : '.xlsx,.xlsm,.xlsb';
    });

    function toggleButton() {
      processBtn.disabled = !(filesInput.files.length > 0 && passwordInput.value.trim() !== '');
    }
    filesInput.addEventListener('change', toggleButton);
    passwordInput.addEventListener('input', toggleButton);

    processBtn.addEventListener('click', async () => {
      output.innerHTML = '';
      issueLog = [];
      downloadLogBtn.style.display = 'none';
      const password = passwordInput.value.trim();
      const files = Array.from(filesInput.files);
      if (!password) return alert('Please enter the password.');
      if (!files.length) return alert('Please select files.');
      processBtn.disabled = true;

      if (fileTypeSelect.value === 'pdf') await processPDFs(files, password);
      else if (fileTypeSelect.value === 'excel') await processExcels(files, password);

      let logText = 'Issue Log\n-------------------------\n';
      issueLog.forEach(e=>{
        logText += `${e.filename}: ${e.status}${e.message ? ' ('+e.message+')' : ''}\n`;
      });
      const blob = new Blob([logText], {type: "text/plain"});
      downloadLogBtn.onclick = ()=> {
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = "unlock_issue_log.txt";
        link.click();
        setTimeout(()=>URL.revokeObjectURL(url),1000);
      };
      downloadLogBtn.style.display = 'block';
      processBtn.disabled = false;
    });

    async function processPDFs(files, password) {
      for (const file of files) {
        const fileResultDiv = document.createElement('div');
        fileResultDiv.className = 'file-result';
        fileResultDiv.textContent = `Processing "${file.name}"...`;
        output.appendChild(fileResultDiv);
        let result = { filename: file.name };
        try {
          const arrayBuffer = await file.arrayBuffer();
          const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer, { password });
          const pdfBytes = await pdfDoc.save();
          const blob = new Blob([pdfBytes], { type: 'application/pdf' });
          const url = URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = url;
          link.download = "unlocked_" + file.name.replace(/\.pdf$/i, '') + ".pdf";
          link.textContent = 'Download';
          link.className = 'download-link';
          fileResultDiv.textContent = `✅ "${file.name}" unlocked.`;
          fileResultDiv.classList.add('success');
          fileResultDiv.appendChild(link);
          result.status = "Success";
        } catch (e) {
          fileResultDiv.textContent = `❌ Error unlocking "${file.name}": ${e.message}`;
          fileResultDiv.classList.add('error');
          result.status = "Failed";
          result.message = e.message;
        }
        issueLog.push(result);
      }
    }

    async function processExcels(files, password) {
      for (const file of files) {
        const fileResultDiv = document.createElement('div');
        fileResultDiv.className = 'file-result';
        fileResultDiv.textContent = `Processing "${file.name}"...`;
        output.appendChild(fileResultDiv);
        let result = { filename: file.name };
        try {
          const arrayBuffer = await file.arrayBuffer();
          let wb;
          try {
            wb = XLSX.read(arrayBuffer, { type: 'array', password });
          } catch (e) {
            throw new Error('Full open password removal not supported for Excel in browser.');
          }
          wb.SheetNames.forEach(name => {
            let sheet = wb.Sheets[name];
            if (sheet && sheet['!protect']) delete sheet['!protect'];
          });
          const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
          const blob = new Blob([wbout], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
          const url = URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = url;
          link.download = "unlocked_" + file.name.replace(/\.(xlsx|xlsm|xlsb)$/i, '') + ".xlsx";
          link.textContent = 'Download';
          link.className = 'download-link';
          fileResultDiv.textContent = `✅ "${file.name}" processed (sheet protection removed if present).`;
          fileResultDiv.classList.add('success');
          fileResultDiv.appendChild(link);
          result.status = "Success";
        } catch (e) {
          fileResultDiv.textContent = `❌ Error processing "${file.name}": ${e.message}`;
          fileResultDiv.classList.add('error');
          result.status = "Failed";
          result.message = e.message;
        }
        issueLog.push(result);
      }
    }

    filesInput.accept = 'application/pdf';
  </script>
</body>
</html>
