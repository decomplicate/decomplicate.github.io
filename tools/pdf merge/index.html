 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PDF Combiner & Extractor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- pdf-lib library for PDF operations -->
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <style>
    body {
      background: #eef4fb;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    .container {
      max-width: 520px;
      background: #fff;
      margin: 40px auto;
      border-radius: 12px;
      box-shadow: 0 8px 32px #183b5712, 0 1.5px 5px #2b6fba20;
      padding: 32px;
    }
    h2 {
      text-align: center;
      color: #215c95;
      margin-bottom: 25px;
      font-weight: 600;
    }
    label {
      display: block;
      margin-bottom: 7px;
      font-weight: 500;
    }
    input[type='file'] {
      display: block;
      margin-bottom: 20px;
    }
    input[type='text'] {
      padding: 8px;
      width: 100%;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-bottom: 20px;
    }
    .actions {
      display: flex;
      gap: 14px;
      justify-content: center;
    }
    button {
      background: linear-gradient(90deg, #387bf9 40%, #5cb7f5 100%);
      color: #fff;
      border: none;
      padding: 12px 26px;
      border-radius: 6px;
      min-width: 120px;
      font-size: 1rem;
      font-weight: 600;
      box-shadow: 0 2px 8px #215c9525;
      cursor: pointer;
      transition: 0.2s;
    }
    button:active {
      transform: scale(0.97);
    }
    #output {
      margin-top: 24px;
      text-align: center;
      min-height: 32px;
      font-size: 1.1rem;
      color: #27773c;
      word-break: break-all;
    }
    .note {
      font-size: 0.96em;
      color: #555;
      margin-top: -10px;
      margin-bottom: 14px;
      text-align: center;
    }
    @media (max-width: 600px) {
      .container {
        padding: 16px;
      }
      button {
        padding: 10px 10px;
        font-size: 1em;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Combine PDFs or Extract pages from PDFs for FREE!!</h2>

    <label for="pdfs">Select PDF files:</label>
    <input type="file" id="pdfs" accept="application/pdf" multiple>
    <div class="note">You can select multiple PDFs for merging.</div>

    <label for="pages">Extract Pages From 1st PDF (e.g. 1,3-4,7):</label>
    <input type="text" id="pages" placeholder="Leave empty to skip extraction (enter e.g. 2,4-6)">
    <div class="note">Enter page numbers/ranges to extract from the <b>first PDF only</b>. (Page indices start at 1)</div>

    <div class="actions">
      <button onclick="combinePDFs()">Merge PDFs</button>
      <button onclick="extractPages()">Extract Pages</button>
    </div>

    <div id="output"></div>
   <div class="info-text">
      <h3>Contact: decomplicate001@gmail.com</h3>
 <h4>For more automations visit and follow: <a href="https://effortlessautomation.wordpress.com/" target="_blank" rel="noopener noreferrer">https://effortlessautomation.wordpress.com/</a></h4>

    </div>
  </div>

  <script>
    async function combinePDFs() {
      const files = document.getElementById('pdfs').files;
      if (!files.length) return showMsg('Please select PDF files to merge!', false);

      const mergedPdf = await PDFLib.PDFDocument.create();

      for (let f of files) {
        const bytes = await f.arrayBuffer();
        const pdf = await PDFLib.PDFDocument.load(bytes);
        const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
        pages.forEach(page => mergedPdf.addPage(page));
      }

      const outBytes = await mergedPdf.save();
      downloadPDF(outBytes, 'merged.pdf');
      showMsg('Merged PDF is ready for download!');
    }

    function parseRanges(rangeStr, maxPage) {
      // e.g. "1,3-5,8"
      if (!rangeStr) return [];
      return rangeStr.split(',').flatMap(part => {
        if (part.includes('-')) {
          let [start, end] = part.split('-').map(Number);
          if (isNaN(start) || isNaN(end)) return [];
          start = Math.max(start, 1); end = Math.min(end, maxPage);
          return Array.from({length: end - start + 1}, (_, i) => start + i - 1);
        }
        let p = Number(part.trim());
        if (!isNaN(p) && p >= 1 && p <= maxPage) return [p - 1];
        return [];
      }).filter((v, i, self) => self.indexOf(v) === i); // Unique
    }

    async function extractPages() {
      const files = document.getElementById('pdfs').files;
      const rangeStr = document.getElementById('pages').value;
      if (!files.length) return showMsg('Please upload at least 1 PDF!', false);

      const bytes = await files[0].arrayBuffer();
      const pdf = await PDFLib.PDFDocument.load(bytes);
      const maxPages = pdf.getPageCount();

      const indices = parseRanges(rangeStr, maxPages);
      if (!indices.length) return showMsg('Please enter valid page numbers/ranges.', false);

      const newPdf = await PDFLib.PDFDocument.create();
      const pages = await newPdf.copyPages(pdf, indices);
      pages.forEach(page => newPdf.addPage(page));

      const outBytes = await newPdf.save();
      downloadPDF(outBytes, 'extracted.pdf');
      showMsg('Extracted PDF is ready for download!');
    }

    function showMsg(msg, ok=true) {
      let el = document.getElementById('output');
      el.style.color = ok ? '#27773c' : '#d14343';
      el.textContent = msg;
    }

    function downloadPDF(bytes, filename) {
      const blob = new Blob([bytes], {type: "application/pdf"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = filename;
      document.body.appendChild(a);
      a.click();
      setTimeout(() => {
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      }, 100);
    }
  </script>
</body>
</html>
