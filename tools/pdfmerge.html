<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Combiner & Extractor | EffortlesslyDone</title>
  <meta name="description" content="Merge multiple PDF files into one or extract specific pages from a PDF. All processing is private and happens in your browser." />
  <meta name="keywords" content="pdf merge, pdf combiner, pdf extractor, pdf tool, merge pdf files, extract pages from pdf" />
  <meta name="author" content="EffortlesslyDone" />
  
  <link rel="stylesheet" href="../style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PBJYBJBFBC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PBJYBJBFBC');
</script>
  <style>
    /* Ensure fixed header stays constant and content doesn't overlap */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 70px; /* lock header height */
      background-color: var(--color-surface);
      box-shadow: var(--shadow-sm);
      z-index: 1000;
    }

    main {
      padding-top: 90px; /* a bit more than header height for breathing room */
    }

    /* Tool-specific overrides inside main theme */
    .tool-container {
      background: var(--color-surface);
      border-radius: var(--radius-base);
      box-shadow: var(--shadow-md);
      padding: var(--space-24);
      margin-top: var(--space-48);
      max-width: 600px;
    }
    .tool-title {
        text-align: center;
        margin: 0;
        color: var(--color-primary);
        font-size: var(--font-size-2xl);
    }
    .tool-desc {
      font-size: var(--font-size-md);
      color: var(--color-text);
      margin-bottom: var(--space-24);
      text-align: center;
      font-weight: var(--font-weight-medium);
    }
    label {
      font-weight: var(--font-weight-bold);
      display: block;
      margin: var(--space-16) 0 var(--space-8);
    }
    input[type='file'],
    input[type='text'] {
      width: 100%;
      padding: var(--space-12);
      font-size: var(--font-size-base);
      box-sizing: border-box;
      border-radius: var(--radius-sm);
      border: 1px solid var(--color-border);
      background: var(--color-background);
      color: var(--color-text);
      transition: border-color 0.2s;
    }
    input:focus {
        border-color: var(--color-primary);
        outline: none;
    }
    .actions {
      display: flex;
      gap: var(--space-12);
      justify-content: center;
      flex-wrap: wrap;
      margin-top: var(--space-24);
    }
    button.tool-btn {
      flex: 1 1 auto;
      min-width: 150px;
      padding: var(--space-12) var(--space-24);
    }
    #output {
      margin-top: var(--space-24);
      text-align: center;
      min-height: 32px;
      font-size: var(--font-size-lg);
      font-weight: var(--font-weight-medium);
      color: var(--color-success);
    }
    .note {
      font-size: var(--font-size-sm);
      color: var(--color-text-secondary);
      margin-top: var(--space-8);
      text-align: center;
    }
    .promo {
      margin-top: var(--space-32);
      text-align: center;
      background: var(--color-background);
      padding: var(--space-16);
      border-radius: var(--radius-sm);
    }
    .promo a {
      color: var(--color-primary);
      text-decoration: underline;
    }
  </style>
  
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
</head>
<body>

  <header class="header">
    <div class="container header__content">
      <div class="header__logo">
        <h1><i class="fas fa-rocket"></i> EffortlesslyDone</h1>
      </div>
      <nav class="header__nav" id="nav">
        <a href="../index.html" class="nav-link">Home</a>
        <a href="../index.html#templates" class="nav-link">Templates</a>
        <a href="../index.html#tools" class="nav-link active">Tools</a>
        <a href="../index.html#games" class="nav-link">Games</a>
        <a href="../index.html#about" class="nav-link">About</a>
      </nav>
      <div class="header__search">
        <input type="text" id="searchInput" class="search-input" placeholder="Search...">
        <button id="searchBtn" class="btn btn--primary search-btn"><i class="fas fa-search"></i></button>
      </div>
      <button id="mobileMenuBtn" class="mobile-menu-btn">
        <span></span><span></span><span></span>
      </button>
    </div>
  </header>

  <main class="container">
    <section class="tool-container">
      <h2 class="tool-title"><i class="fas fa-file-pdf"></i> PDF Combiner & Extractor</h2>
      <div class="tool-desc">
        Merge multiple PDFs into one, or extract specific pages from a single PDF. Free, secure, and all in your browser.
      </div>

      <label for="pdfs">Select PDF files:</label>
      <input type="file" id="pdfs" accept="application/pdf" multiple>
      <div class="note">You can select multiple PDFs for merging.</div>

      <label for="pages">Extract Pages from 1st PDF (e.g., 1,3-4,7):</label>
      <input type="text" id="pages" placeholder="Leave empty to merge all PDFs (e.g. 2,4-6)">
      <div class="note">Enter page numbers/ranges to extract from the <b>first PDF only</b>. (Page indices start at 1)</div>

      <div class="actions">
        <button onclick="combinePDFs()" class="btn btn--primary tool-btn">Merge PDFs</button>
        <button onclick="extractPages()" class="btn btn--secondary tool-btn">Extract Pages</button>
      </div>

      <div id="output"></div>
      
      <div class="promo">
        More automation tools on <a href="../index.html">‚Üê Back to Home</a><br>
        Contact: <a href="mailto:decomplicate001@gmail.com">decomplicate001@gmail.com</a>
      </div>
    </section>
  </main>
  
  <footer class="footer">
    <div class="container footer__content">
      <div class="footer__section">
        <h3>EffortlesslyDone</h3>
        <p>Simplifying your digital life, one tool at a time.</p>
      </div>
    </div>
  </footer>

  <script src="../app.js" defer></script>
  <script>
    async function combinePDFs() {
      const files = document.getElementById('pdfs').files;
      if (!files.length) return showMsg('Please select PDF files to merge!', false);

      const mergedPdf = await PDFLib.PDFDocument.create();

      for (let f of files) {
        try {
            const bytes = await f.arrayBuffer();
            const pdf = await PDFLib.PDFDocument.load(bytes);
            const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
            pages.forEach(page => mergedPdf.addPage(page));
        } catch (error) {
            showMsg(`Failed to process ${f.name}: ${error.message}`, false);
            return;
        }
      }

      const outBytes = await mergedPdf.save();
      downloadPDF(outBytes, 'merged.pdf');
      showMsg('Merged PDF is ready for download!');
    }

    function parseRanges(rangeStr, maxPage) {
      if (!rangeStr) return [];
      return rangeStr.split(',').flatMap(part => {
        if (part.includes('-')) {
          let [start, end] = part.split('-').map(Number);
          if (isNaN(start) || isNaN(end)) return [];
          start = Math.max(start, 1); end = Math.min(end, maxPage);
          return Array.from({length: end - start + 1}, (_, i) => start + i - 1);
        }
        let p = Number(part.trim());
        if (!isNaN(p) && p >= 1 && p <= maxPage) return [p - 1];
        return [];
      }).filter((v, i, self) => self.indexOf(v) === i); // Unique
    }

    async function extractPages() {
      const files = document.getElementById('pdfs').files;
      const rangeStr = document.getElementById('pages').value;
      if (!files.length) return showMsg('Please upload at least 1 PDF!', false);

      try {
        const bytes = await files[0].arrayBuffer();
        const pdf = await PDFLib.PDFDocument.load(bytes);
        const maxPages = pdf.getPageCount();

        const indices = parseRanges(rangeStr, maxPages);
        if (!indices.length) return showMsg('Please enter valid page numbers/ranges.', false);

        const newPdf = await PDFLib.PDFDocument.create();
        const pages = await newPdf.copyPages(pdf, indices);
        pages.forEach(page => newPdf.addPage(page));

        const outBytes = await newPdf.save();
        downloadPDF(outBytes, 'extracted.pdf');
        showMsg('Extracted PDF is ready for download!');
      } catch (error) {
        showMsg(`Failed to extract pages: ${error.message}`, false);
      }
    }

    function showMsg(msg, ok=true) {
      let el = document.getElementById('output');
      el.style.color = ok ? 'var(--color-success)' : 'var(--color-error)';
      el.textContent = msg;
    }

    function downloadPDF(bytes, filename) {
      const blob = new Blob([bytes], {type: "application/pdf"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = filename;
      document.body.appendChild(a);
      a.click();
      setTimeout(() => {
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      }, 100);
    }
  </script>
</body>

</html>
