<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PBJYBJBFBC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PBJYBJBFBC');
</script>
<title>Tic Tac Toe Enhanced</title>
<style>
  body {
    background: radial-gradient(circle at 60% 70%, #0fd850 10%, #f9f047 90%);
    min-height: 100vh;
    margin: 0;
    font-family: 'Roboto', Arial, sans-serif;
    display: flex; flex-direction: column; align-items: center; justify-content: flex-start;
  }
  h1 {
    margin-top: 2rem; color: #183153; letter-spacing: 2px;
    text-shadow: 2px 2px 8px #fff8;
  }
  #toolbar {
    margin: 1.5rem 0 1rem 0;
    display: flex; gap: 1rem;
  }
  #toolbar select, #toolbar button {
    border: none; border-radius: 10px;
    padding: 0.6rem 1.2rem;
    font-weight: bold; font-size: 1rem;
    background: #182848; color: #fffa; box-shadow: 0 2px 8px #0002;
    cursor: pointer; transition: background 0.2s;
  }
  #toolbar select:focus, #toolbar button:focus { outline: 2px solid #8ae6d0; }
  #toolbar button.active, #toolbar select:active, #toolbar select:focus { background: #07a; color: #fff; }
  .board {
    display: grid;
    gap: 12px;
    margin-bottom: 1.5rem;
    transition: all 0.3s;
    background: #fff4; border-radius: 20px; padding: 18px 18px 8px 18px;
    box-shadow: 0 4px 24px #0002;
  }
  .cell {
    width: 70px; height: 70px;
    background: #23232311; border-radius: 12px;
    box-shadow: 0 1px 5px #3331;
    font-size: 2.8rem; display: flex;
    align-items: center; justify-content: center;
    cursor: pointer; transition: background .2s;
    position: relative; user-select: none;
  }
  .cell:hover:not(.disabled):not(.won) { background: #52e5e7cc; }
  .cell.disabled { pointer-events: none; color: #bbb; }
  .cell.won { background: #ffe53b; color: #07427a; border: 2px solid #ff9a06; }
  #status {
    font-size: 1.3rem; margin-bottom: 1.2rem;
    color: #0f0d36; min-height: 1.8em;
    text-shadow: 1px 1px 2px #fff, 0 0 10px #abf6f1;
  }
  .theme-switcher { margin: auto 1rem; }
  .theme-dark { background: linear-gradient(135deg, #1f1c2c 0%, #928dab 100%); }
  /* Example animation for confetti burst */
  @keyframes burst { 0%{transform:scale(.8);} 60%{transform:scale(1.5);} 100%{transform:scale(1);} }
  .confetti { animation: burst 0.5s; }
</style>
</head>
<body>
  <h1>Tic Tac Toe Deluxe</h1>
  <div id="toolbar">
    <select id="difficulty">
      <option value="easy">Easy</option>
      <option value="medium" selected>Medium</option>
      <option value="hard">Hard</option>
    </select>
    <select id="boardsize">
      <option value="3">3x3</option>
      <option value="5">5x5</option>
      <option value="7">7x7</option>
    </select>
    <button id="restart-btn">Restart</button>
    <button id="theme-btn">Switch Theme</button>
    <button id="twoplayer-btn">2 Player Mode</button>
  </div>
<!-- Add this after the toolbar div -->

<div id="rules-container" style="max-width: 480px; margin: 0 auto 1.5rem auto; text-align: left; background: #ffffffcc; padding: 1rem 1.5rem; border-radius: 12px; box-shadow: 0 2px 10px #00000022;">
  <button id="toggle-rules-btn" style="background:#07a;color:#fff;border:none;padding:0.4rem 0.8rem;border-radius:8px;cursor:pointer; font-weight:bold; margin-bottom:1rem;">Show Game Rules</button>
  <div id="rules-text" style="display:none; font-size: 1rem; color: #333; line-height:1.4;">
    <strong>Game Rules:</strong>
    <ul style="padding-left: 1.2rem; margin: 0.5rem 0;">
      <li>The classic Tic Tac Toe is played on a 3x3 grid. Bigger grids (5x5, 7x7) require 4 in a row to win.</li>
      <li>Players take turns placing their marks (X or O) in empty cells.</li>
      <li>The goal is to complete a row, column, or diagonal with your marks.</li>
      <li>First player to do so wins the game.</li>
      <li>If all cells fill without a winner, the game is a tie.</li>
    </ul>
  </div>
</div>

  <div class="board" id="board"></div>
  <div id="status"></div>
<script>
const boardDiv = document.getElementById('board');
const statusEl = document.getElementById('status');
const diffSel = document.getElementById('difficulty');
const sizeSel = document.getElementById('boardsize');
const restartBtn = document.getElementById('restart-btn');
const themeBtn = document.getElementById('theme-btn');
const twoPlayerBtn = document.getElementById('twoplayer-btn');
let board, size = 3, neededToWin = 3, moves, isOver, turn, playerChar, aiChar, twoPlayerMode = false, themeDark = false;
function svgX(){ return `<svg width='44px' height='44px'><line x1='5' y1='7' x2='39' y2='39' stroke='#3a5cfa' stroke-width='8'/><line x1='39' y1='7' x2='5' y2='39' stroke='#3a5cfa' stroke-width='8'/></svg>`;}
function svgO(){ return `<svg width='44px' height='44px'><circle cx='22' cy='22' r='16' stroke='#fc4a1a' stroke-width='7' fill='none'/></svg>`;}
function setBoardGrid(){ boardDiv.innerHTML = ''; boardDiv.style.gridTemplateColumns = `repeat(${size}, 70px)`;board = Array(size * size).fill(null); moves=0; isOver=false;turn=0;playerChar='X';aiChar='O';
  for(let i=0;i<size*size;i++){const cell=document.createElement('div');cell.className='cell';cell.dataset.index=i;boardDiv.appendChild(cell);}
  updateStatus(`Player 1's turn (X)`);}
function updateStatus(msg){statusEl.textContent=msg;}
function getComboIndexes(){let arr = [];for(let r=0;r<size;r++)arr.push([...Array(size).keys()].map(c=>r*size+c));
  for(let c=0;c<size;c++)arr.push([...Array(size).keys()].map(r=>r*size+c));
  arr.push([...Array(size).keys()].map(i=>i*size+i));
  arr.push([...Array(size).keys()].map(i=>(size-1-i)*size+i));
  if(size>3){for(let r=0;r<=size-neededToWin;r++)for(let c=0;c<=size-neededToWin;c++){
    let diag=[],anti=[];for(let x=0;x<neededToWin;x++){diag.push((r+x)*size+c+x);anti.push((r+neededToWin-1-x)*size+c+x);}
    arr.push(diag);arr.push(anti);}
    for(let r=0;r<size;r++)for(let c=0;c<=size-neededToWin;c++)arr.push([...Array(neededToWin).keys()].map(x=>r*size+c+x));
    for(let c=0;c<size;c++)for(let r=0;r<=size-neededToWin;r++)arr.push([...Array(neededToWin).keys()].map(x=>(r+x)*size+c));
  } return arr;}
function checkWinner(){const combos=getComboIndexes();for(let w of combos){
    let sym=board[w[0]]; if(sym && w.every(i=>board[i]===sym)){
      w.forEach(i=>boardDiv.children[i].classList.add('won','confetti'));
      updateStatus((sym==='X'&&(!twoPlayerMode||turn%2===0)||sym==='O'&&twoPlayerMode&&turn%2)?"Player 1 Wins!":"Player 2 Wins!");
      isOver=true;return true;}}if(moves>=board.length){updateStatus("It's a tie!");isOver=true;}}
function computerMove(){
  let avail=board.map((v,i)=>v==null?i:null).filter(i=>i!=null);
  let index;
  if(diffSel.value==='easy'){index=avail[Math.floor(Math.random()*avail.length)];}
  else if(diffSel.value==='medium'){index=mediumAIMove();}
  else{index=hardAIMove();}
  placeAt(index,aiChar);}
function mediumAIMove(){
  for(let i=0;i<board.length;i++){if(board[i]==null){board[i]=aiChar;if(checkWin(aiChar)){board[i]=null;return i;}board[i]=null;}}
  for(let i=0;i<board.length;i++){if(board[i]==null){board[i]=playerChar;if(checkWin(playerChar)){board[i]=null;return i;}board[i]=null;}}
  return board.map((v,i)=>v==null?i:null).filter(i=>i!=null)[0];
}
function checkWin(player){let combos=getComboIndexes();return combos.some(c=>c.every(i=>board[i]===player));}
function hardAIMove(){
  function minimax(b,p,depth=0){
    if(checkWin(aiChar))return{score:10-depth};if(checkWin(playerChar))return{score:depth-10};
    if(b.every(x=>x))return{score:0};let mv=[],avail=b.map((v,i)=>v==null?i:null).filter(i=>i!=null);
    for(let ind of avail){b[ind]=p;let val=p===aiChar?minimax(b,playerChar,depth+1):minimax(b,aiChar,depth+1);mv.push({i:ind,score:val.score});b[ind]=null;}
    return p===aiChar?mv.reduce((a,b)=>a.score>b.score?a:b):mv.reduce((a,b)=>a.score<b.score?a:b);}
  return minimax([...board],aiChar).i;
}
function placeAt(idx,mark){
  if(isOver||board[idx]!=null)return;board[idx]=mark;const cell=boardDiv.children[idx];cell.innerHTML=mark==='X'?svgX():svgO();
  cell.classList.add('disabled','confetti');moves++;checkWinner();
  if(!isOver){
    if(twoPlayerMode){turn++;updateStatus(turn%2===0?`Player 1's turn (X)`:`Player 2's turn (O)`);}
    else if(mark===playerChar){setTimeout(computerMove,350);}
  }
}
boardDiv.addEventListener('click',e=>{
  if(e.target.classList.contains('cell')&&!e.target.classList.contains('disabled')&&!isOver){
    if(twoPlayerMode)placeAt(+e.target.dataset.index,turn%2===0?'X':'O');
    else placeAt(+e.target.dataset.index,playerChar);
  }
});
diffSel.addEventListener('change',()=>{if(!twoPlayerMode)restartBtn.click();});
sizeSel.addEventListener('change',()=>{size=+sizeSel.value;neededToWin=size>3?4:3;setBoardGrid();});
restartBtn.addEventListener('click',()=>{setBoardGrid();});
themeBtn.addEventListener('click',()=>{
  themeDark=!themeDark;document.body.classList.toggle('theme-dark',themeDark);
  themeBtn.textContent=themeDark?'Light Theme':'Dark Theme';
});
twoPlayerBtn.addEventListener('click',()=>{
  twoPlayerMode=!twoPlayerMode;twoPlayerBtn.classList.toggle('active',twoPlayerMode);
  twoPlayerBtn.textContent=twoPlayerMode?'Single Player':'2 Player Mode';restartBtn.click();
});
setBoardGrid();
const toggleRulesBtn = document.getElementById('toggle-rules-btn');
const rulesText = document.getElementById('rules-text');

toggleRulesBtn.addEventListener('click', () => {
  const visible = rulesText.style.display === 'block';
  rulesText.style.display = visible ? 'none' : 'block';
  toggleRulesBtn.textContent = visible ? 'Show Game Rules' : 'Hide Game Rules';
});

</script>
</body>
</html>

